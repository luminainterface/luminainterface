FROM python:3.11-slim

WORKDIR /app

# Install system dependencies
RUN apt-get update && apt-get install -y \
    curl \
    wget \
    docker.io \
    docker-compose \
    && rm -rf /var/lib/apt/lists/*

# Copy requirements and install Python dependencies
COPY requirements.txt .
RUN pip install --no-cache-dir -r requirements.txt

# Install additional deployment dependencies
RUN pip install docker docker-compose psutil

# Copy application code
COPY deploy_confidence_driven_system.py .

# Copy all confidence system files
COPY docker-compose-v10-ultimate.yml .
COPY Dockerfile.confidence-driven-lora .
COPY Dockerfile.ultimate-chat-confidence .
COPY confidence_driven_lora_creator.py .
COPY ultimate_chat_orchestrator_with_confidence.py .

# Create directories
RUN mkdir -p /app/reports /app/logs

# Run the deployer
CMD ["python", "deploy_confidence_driven_system.py"] 